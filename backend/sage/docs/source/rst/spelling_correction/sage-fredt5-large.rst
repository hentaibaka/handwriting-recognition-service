üéØ sage-fredt5-large
-------------------

The model is a part of `SAGE v1.1.0 release <https://huggingface.co/collections/ai-forever/sage-v110-release-660abac12d0769b9c67be501>`_

.. image:: ../../images/sage_banner.jpg
   :align: center

The model corrects spelling and punctuation errors and typos by bringing all the words in the text to the norm of the Russian language.
Corrector had been trained based on the model `FredT5-large <https://huggingface.co/ai-forever/FRED-T5-large>`_.
An extensive dataset with ‚Äúartificial‚Äù errors was taken as a training corpus: the corpus was assembled on the basis of the Russian-language Wikipedia and transcripts of Russian-language videos, then typos and spelling errors were automatically introduced into it using the library `SAGE library <https://github.com/ai-forever/sage>`_.


Table of contents
^^^^^^^^^^^^^^^^^

* `Public references <#id1>`_
* `Examples <#id2>`_
* `Metrics <#id3>`_
* `How to use <#id4>`_
* `API <#id5>`_
* `Limitations <#id6>`_
* `Resources <#id7>`_
* `License <#id10>`_
* `Specifications <#id11>`_
* `Contacts <#id12>`_


Public references
^^^^^^^^^^^^^^^^^

- `SAGE library announcement <https://youtu.be/yFfkV0Qjuu0>`_, DataFest 2023
- `Paper about synthetic error generation methods <https://www.dialog-21.ru/media/5914/martynovnplusetal056.pdf>`_, Dialogue 2023
- `EACL 2024 paper <https://aclanthology.org/2024.findings-eacl.10/>`_


Examples
^^^^^^^^^

+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Input                                                                                                                                                                                                                                                                                                                                               | Output                                                                                                                                                                                                                                                                                                                                                  |
+=====================================================================================================================================================================================================================================================================================================================================================+=========================================================================================================================================================================================================================================================================================================================================================+
| –ò –Ω–µ —á—Å–Ω–æ –ø—Ä–æ—Ö–æ–∂–∏–º –≤ —ç—Ç–æ—Ç –¥–µ–Ω—å –Ω–µ–ø–æ–≥–æ–∂–π–∏ –ø–æ—á–µ–º—É —è –≤–µ—Å–µ–ª—ã–π —Ç–∞–∫–π–æ                                                                                                                                                                                                                                                                                     | –ò –Ω–µ —è—Å–Ω–æ –ø—Ä–æ—Ö–æ–∂–∏–º –≤ —ç—Ç–æ—Ç –¥–µ–Ω—å –Ω–µ–ø–æ–≥–æ–∂–∏–π, –ø–æ—á–µ–º—É —è –≤–µ—Å–µ–ª—ã–π —Ç–∞–∫–æ–π.                                                                                                                                                                                                                                                                                       |
+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| –ö–∞–∂–¥–π –¥–µ–Ω—å –≤–æ—Ç—Ç–∞–∫ –¥–µ–ª–æ–π, –∏ —Å–ø–µ–Ω–∞ –±–∞–ª–µ—Ç—å –Ω–∏–±—É–¥–µ—Ç. –ê –≤–æ—Ç–∞–∫ –∫–∞–∂–¥—ã–π –¥–µ–Ω—å –Ω–∏–¥–µ–ª–∞–π                                                                                                                                                                                                                                                                        | –ö–∞–∂–¥—ã–π –¥–µ–Ω—å –≤–æ—Ç —Ç–∞–∫ –¥–µ–ª–∞–π –∏ —Å–ø–∏–Ω–∞ –±–æ–ª–µ—Ç—å –Ω–µ –±—É–¥–µ—Ç. –ê –≤–æ—Ç —Ç–∞–∫ –∫–∞–∂–¥—ã–π –¥–µ–Ω—å –Ω–µ –¥–µ–ª–∞–π.                                                                                                                                                                                                                                                                      |
+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| –û—Å–Ω–æ–≤–∞—è —Ü–µ–ª—å –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è  –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∞—è –æ—Ç—Ä–∞–±–æ—Ç–∫–∞ –Ω–∞–≤—ã–∫–æ–≤ –ø–æ –æ–∫–∞–∑–∞–Ω–∏—é –ø–æ–º–æ—â–∏ –≥—Ä–∞–∂–¥–∞–Ω–∞–º, –ø–æ–ø–∞–≤—à–∏–º –≤ –î–¢–ü –∞ —Ç–∞–∫–∂–µ –ø–æ–≤—ã—à–µ–Ω–∏–µ –∏ —Å–æ–≤–µ—Ä—à–µ–Ω—Å—Ç–≤–æ–≤–∞–Ω–∏–µ —É—Ä–æ–≤–Ω—è –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ–π –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –ú–ß–° –ø—Ä–∏ –ø—Ä–æ–≤–µ–¥–µ–Ω–∏–∏ –∞–≤–∞—Ä–∏–π–Ω–æ-—Å–ø–∞—Å–∞—Ç–µ–ª—å–Ω—ã—Ö —Ä–∞–±–æ—Ç –ø–æ –ª–∏–∫–≤–∏–¥–∞—Ü–∏–∏ –ø–æ—Å–ª–µ–¥—Å—Ç–≤–∏–π –¥–æ—Ä–æ–∂–Ω–æ-—Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω—ã—Ö –ø—Ä–æ–∏—à–µ—Å—Ç–≤–∏–π —Å–æ–∫—Ä–∞—â–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π —Ä–µ–∞–≥–∏—Ä–æ–≤–∞–Ω–∏—è. | –û—Å–Ω–æ–≤–Ω–∞—è —Ü–µ–ª—å –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è ‚Äî –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∞—è –æ—Ç—Ä–∞–±–æ—Ç–∫–∞ –Ω–∞–≤—ã–∫–æ–≤ –ø–æ –æ–∫–∞–∑–∞–Ω–∏—é –ø–æ–º–æ—â–∏ –≥—Ä–∞–∂–¥–∞–Ω–∞–º, –ø–æ–ø–∞–≤—à–∏–º –≤ –î–¢–ü, –∞ —Ç–∞–∫–∂–µ –ø–æ–≤—ã—à–µ–Ω–∏–µ –∏ —Å–æ–≤–µ—Ä—à–µ–Ω—Å—Ç–≤–æ–≤–∞–Ω–∏–µ —É—Ä–æ–≤–Ω—è –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ–π –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –ú–ß–° –ø—Ä–∏ –ø—Ä–æ–≤–µ–¥–µ–Ω–∏–∏ –∞–≤–∞—Ä–∏–π–Ω–æ-—Å–ø–∞—Å–∞—Ç–µ–ª—å–Ω—ã—Ö —Ä–∞–±–æ—Ç –ø–æ –ª–∏–∫–≤–∏–¥–∞—Ü–∏–∏ –ø–æ—Å–ª–µ–¥—Å—Ç–≤–∏–π –¥–æ—Ä–æ–∂–Ω–æ-—Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω—ã—Ö –ø—Ä–æ–∏—Å—à–µ—Å—Ç–≤–∏–π, —Å–æ–∫—Ä–∞—â–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π —Ä–µ–∞–≥–∏—Ä–æ–≤–∞–Ω–∏—è |
+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+


Metrics
^^^^^^^^^

Below are automatic metrics for determining the correctness of the spell checkers.
We compare our solution with both open automatic spell checkers and the ChatGPT family of models on all four available datasets:
- **RUSpellRU**: texts collected from (`LiveJournal <https://www.livejournal.com/media>`_), with manually corrected typos and errors;
- **MultidomainGold**: examples from 7 text sources, including the open web, news, social media, reviews, subtitles, policy documents and literary works;
- **MedSpellChecker**: texts with errors from medical anamnesis;
- **GitHubTypoCorpusRu**: spelling errors and typos in commits from GitHub;


**RUSpellRU**

+------------------------+-------------+--------------+------------+------------+-------------+-----------+------------+-------------+-----------+
| Model                  | Pr. (spell) | Rec. (spell) | F1 (spell) | Pr. (punc) | Rec. (punc) | F1 (punc) | Pr. (case) | Rec. (case) | F1 (case) |
+========================+=============+==============+============+============+=============+===========+============+=============+===========+
| sage-fredt5-large      | 57.3        | 68.0         | 62.2       | 86.7       | 46.1        | 60.2      | 92.1       | 67.8        | 78.1      |
+------------------------+-------------+--------------+------------+------------+-------------+-----------+------------+-------------+-----------+
| sage-fredt5-large (ft) | 88.4        | 80.9         | 84.5       | 88.2       | 85.3        | 86.8      | 95.5       | 94.0        | 94.7      |
+------------------------+-------------+--------------+------------+------------+-------------+-----------+------------+-------------+-----------+
| sage-ai-service        | 90.3        | 86.3         | 88.2       | 90.3       | 86.6        | 88.4      | 95.2       | 95.9        | 95.6      |
+------------------------+-------------+--------------+------------+------------+-------------+-----------+------------+-------------+-----------+
| gpt-3.5-turbo          | 33.6        | 58.5         | 42.7       | 85.9       | 64.6        | 73.7      | 84.9       | 73.9        | 79.0      |
+------------------------+-------------+--------------+------------+------------+-------------+-----------+------------+-------------+-----------+
| gpt-4                  | 54.9        | 76.7         | 64.0       | 84.0       | 82.3        | 83.2      | 91.5       | 90.2        | 90.9      |
+------------------------+-------------+--------------+------------+------------+-------------+-----------+------------+-------------+-----------+


**MultidomainGold**

+------------------------+-------------+--------------+------------+------------+-------------+-----------+------------+-------------+-----------+
| Model                  | Pr. (spell) | Rec. (spell) | F1 (spell) | Pr. (punc) | Rec. (punc) | F1 (punc) | Pr. (case) | Rec. (case) | F1 (case) |
+========================+=============+==============+============+============+=============+===========+============+=============+===========+
| sage-fredt5-large      | 43.4        | 49.7         | 46.3       | 21.8       | 21.3        | 21.6      | 58.8       | 23.9        | 34.0      |
+------------------------+-------------+--------------+------------+------------+-------------+-----------+------------+-------------+-----------+
| sage-fredt5-large (ft) | 80.3        | 75.1         | 77.6       | 69.0       | 66.5        | 67.7      | 78.6       | 80.0        | 79.3      |
+------------------------+-------------+--------------+------------+------------+-------------+-----------+------------+-------------+-----------+
| sage-ai-service        | 81.6        | 77.7         | 79.6       | 70.2       | 67.5        | 68.8      | 80.5       | 80.5        | 80.5      |
+------------------------+-------------+--------------+------------+------------+-------------+-----------+------------+-------------+-----------+
| gpt-3.5-turbo          | 18.8        | 48.1         | 27.1       | 42.0       | 31.8        | 36.2      | 47.1       | 51.3        | 49.1      |
+------------------------+-------------+--------------+------------+------------+-------------+-----------+------------+-------------+-----------+
| gpt-4                  | 25.4        | 68.0         | 37.0       | 57.8       | 54.3        | 56.0      | 54.0       | 67.5        | 60.0      |
+------------------------+-------------+--------------+------------+------------+-------------+-----------+------------+-------------+-----------+


**MedSpellChecker**

+------------------------+-------------+--------------+------------+------------+-------------+-----------+------------+-------------+-----------+
| Model                  | Pr. (spell) | Rec. (spell) | F1 (spell) | Pr. (punc) | Rec. (punc) | F1 (punc) | Pr. (case) | Rec. (case) | F1 (case) |
+========================+=============+==============+============+============+=============+===========+============+=============+===========+
| sage-fredt5-large      | 35.2        | 54.5         | 42.8       | 19.2       | 13.2        | 15.7      | 48.7       | 36.8        | 41.9      |
+------------------------+-------------+--------------+------------+------------+-------------+-----------+------------+-------------+-----------+
| sage-fredt5-large (ft) | 72.5        | 72.2         | 72.3       | 74.6       | 66.4        | 70.3      | 79.3       | 85.1        | 82.1      |
+------------------------+-------------+--------------+------------+------------+-------------+-----------+------------+-------------+-----------+
| sage-ai-service        | 71.3        | 73.5         | 72.4       | 75.1       | 69.2        | 72.0      | 80.9       | 72.8        | 76.6      |
+------------------------+-------------+--------------+------------+------------+-------------+-----------+------------+-------------+-----------+
| gpt-3.5-turbo          | 14.7        | 45.9         | 22.3       | 69.9       | 52.3        | 59.8      | 26.4       | 41.8        | 32.3      |
+------------------------+-------------+--------------+------------+------------+-------------+-----------+------------+-------------+-----------+
| gpt-4                  | 37.8        | 72.3         | 49.6       | 81.4       | 64.3        | 71.9      | 73.0       | 62.1        | 67.1      |
+------------------------+-------------+--------------+------------+------------+-------------+-----------+------------+-------------+-----------+


**GitHubTypoCorpusRu**

+------------------------+-------------+--------------+------------+------------+-------------+-----------+------------+-------------+-----------+
| Model                  | Pr. (spell) | Rec. (spell) | F1 (spell) | Pr. (punc) | Rec. (punc) | F1 (punc) | Pr. (case) | Rec. (case) | F1 (case) |
+========================+=============+==============+============+============+=============+===========+============+=============+===========+
| sage-fredt5-large      | 46.0        | 46.6         | 46.3       | 22.7       | 18.3        | 20.2      | 12.0       | 13.2        | 12.6      |
+------------------------+-------------+--------------+------------+------------+-------------+-----------+------------+-------------+-----------+
| sage-fredt5-large (ft) | 67.5        | 53.2         | 59.5       | 48.5       | 38.0        | 42.6      | 37.3       | 50.0        | 42.7      |
+------------------------+-------------+--------------+------------+------------+-------------+-----------+------------+-------------+-----------+
| sage-ai-service        | 70.8        | 56.3         | 62.7       | 48.9       | 35.8        | 41.4      | 32.9       | 45.3        | 38.1      |
+------------------------+-------------+--------------+------------+------------+-------------+-----------+------------+-------------+-----------+
| gpt-3.5-turbo          | 23.7        | 38.7         | 29.4       | 37.6       | 23.3        | 28.7      | 19.6       | 35.9        | 25.3      |
+------------------------+-------------+--------------+------------+------------+-------------+-----------+------------+-------------+-----------+
| gpt-4                  | 27.0        | 52.8         | 35.7       | 45.9       | 32.6        | 38.2      | 25.7       | 36.8        | 30.2      |
+------------------------+-------------+--------------+------------+------------+-------------+-----------+------------+-------------+-----------+



How to use
^^^^^^^^^^^^

.. code-block:: python

    from transformers import AutoTokenizer, AutoModelForSeq2SeqLM

    tokenizer = AutoTokenizer.from_pretrained("ai-forever/sage-fredt5-large")
    model = AutoModelForSeq2SeqLM.from_pretrained("ai-forever/sage-fredt5-large", device_map='cuda')

    sentence = "–ò –Ω–µ —á—Å–Ω–æ –ø—Ä–æ—Ö–æ–∂–∏–º –≤ —ç—Ç–æ—Ç –¥–µ–Ω—å –Ω–µ–ø–æ–≥–æ–∂–π–∏ –ø–æ—á–µ–º—É —è –≤–µ—Å–µ–ª—ã–π —Ç–∞–∫–π–æ"
    inputs = tokenizer(sentence, max_length=None, padding="longest", truncation=False, return_tensors="pt")
    outputs = model.generate(**inputs.to(model.device), max_length = inputs["input_ids"].size(1) * 1.5)
    print(tokenizer.batch_decode(outputs, skip_special_tokens=True))

    # ["–ò –Ω–µ —è—Å–Ω–æ –ø—Ä–æ—Ö–æ–∂–∏–º –≤ —ç—Ç–æ—Ç –¥–µ–Ω—å –Ω–µ–ø–æ–≥–æ–∂–∏–π, –ø–æ—á–µ–º—É —è –≤–µ—Å—ë–ª—ã–π —Ç–∞–∫–æ–π?"]


API
^^^^^

.. autoclass:: sage.spelling_correction.t5_correctors.T5ModelForSpellingCorruption
    :members:
    :inherited-members:
    :show-inheritance:


Limitations
^^^^^^^^^^^^

- The model is intended to be fine-tuned on sets with natural errors for better performance. The released model is a pre-train and pre-train task is different from the usual spell checking in terms of density of the noise in a corpus and its origin;
- Complex formatting may cause some trouble in output generation.


Resources
^^^^^^^^^^^^

- `SAGE library <https://github.com/ai-forever/sage>`_, GitHub
- `sage-fredt5-large <https://huggingface.co/ai-forever/sage-fredt5-large>`_, HuggingFace
- `sage-fredt5-distilled-95m <https://huggingface.co/ai-forever/sage-fredt5-distilled-95m>`_, HuggingFace
- `sage-m2m100-1.2B <https://huggingface.co/ai-forever/sage-m2m100-1.2B>`_, HuggingFace
- `sage-mt5-large <https://huggingface.co/ai-forever/sage-mt5-large>`_, HuggingFace


License
^^^^^^^^^

Model `FRED-T5-large <https://huggingface.co/ai-forever/FRED-T5-large>`_, on the basis of which our solution is made, and its source code are supplied under the MIT license.
Our solution also comes with MIT license.

Specifications
^^^^^^^^^^^^^^^
- File size: 3.3 Gb;
- Framework: pytorch
- Format: AI Service
- Version: v1.0
- Developer: SberDevices, AGI NLP

Contacts
^^^^^^^^^^^
nikita.martynov.98@list.ru

