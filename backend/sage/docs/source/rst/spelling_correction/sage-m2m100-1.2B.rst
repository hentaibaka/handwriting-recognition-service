üéØ sage-m2m100-1.2B
-------------------

The model is a part of `SAGE v1.1.0 release <https://huggingface.co/collections/ai-forever/sage-v110-release-660abac12d0769b9c67be501>`_

.. image:: ../../images/sage_banner.jpg
   :align: center

The model corrects spelling errors and typos by bringing all the words in the text to the norm of the Russian language.
Corrector was trained based on the model `M2M100-1.2B <https://huggingface.co/facebook/m2m100_1.2B>`_.
An extensive dataset with ‚Äúartificial‚Äù errors was taken as a training corpus: the corpus was assembled on the basis of the Russian-language Wikipedia and transcripts of Russian-language videos, then typos and spelling errors were automatically introduced into it using the library `SAGE library <https://github.com/ai-forever/sage>`_.
The model is the fine-tuned version of the `pre-train <https://huggingface.co/ai-forever/RuM2M100-1.2B>`_.


Table of contents
^^^^^^^^^^^^^^^^^

* `Public references <#id1>`_
* `Examples <#id2>`_
* `Metrics <#id3>`_
* `How to use <#id4>`_
* `API <#id5>`_
* `Limitations <#id6>`_
* `Resources <#id7>`_
* `License <#id10>`_
* `Specifications <#id12>`_
* `Contacts <#id13>`_


Public references
^^^^^^^^^^^^^^^^^

- `SAGE library announcement <https://youtu.be/yFfkV0Qjuu0>`_, DataFest 2023
- `Paper about synthetic error generation methods <https://www.dialog-21.ru/media/5914/martynovnplusetal056.pdf>`_, Dialogue 2023
- `EACL 2024 paper <https://aclanthology.org/2024.findings-eacl.10/>`_


Examples
^^^^^^^^^

+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Input                                                                                                                                                                                                                                                                                                                                                  | Output                                                                                                                                                                                                                                                                                                                                                   |
+========================================================================================================================================================================================================================================================================================================================================================+==========================================================================================================================================================================================================================================================================================================================================================+
| –î—É–º—é –µ—à—Ü—ä–∞ –ª–µ—Ç —á–µ—Ä–µ–∞ 10 —Ä–µ—Ç—Ä–æ—Å–ø–µ–∫—Ç–∏–≤–Ω–æ –ø—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–æ—Ç—å—ç —Ç–æ –±—É–¥–∫–µ—Ç—Ü—Ü –º–Ω–µ –Ω–µ–≤–µ—Ä–æ—è —Ç–Ω–∞ –∏–Ω —Ç–µ —Ä –Ω–æ                                                                                                                                                                                                                                                           | –î—É–º–∞—é —á—Ç–æ –ª–µ—Ç —á–µ—Ä–µ–∑ 10 —Ä–µ—Ç—Ä–æ—Å–ø–µ–∫—Ç–∏–≤–Ω–æ –ø—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å —ç—Ç–æ –±—É–¥–µ—Ç –º–Ω–µ –Ω–µ–≤–µ—Ä–æ—è—Ç–Ω–æ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ                                                                                                                                                                                                                                                                   |
+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| –û—Å–Ω–æ–≤–∞—è —Ü–µ–ª—å –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è - –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∞—è –æ—Ç—Ä–∞–±–æ—Ç–∫–∞ –Ω–∞–≤—ã–∫–æ–≤ –ø–æ –æ–∫–∞–∑–∞–Ω–∏—é –ø–æ–º–æ—â–∏ –≥—Ä–∞–∂–¥–∞–Ω–∞–º, –ø–æ–ø–∞–≤—à–∏–º –≤ –î–¢–ü, –∞ —Ç–∞–∫–∂–µ –ø–æ–≤—ã—à–µ–Ω–∏–µ –∏ —Å–æ–≤–µ—Ä—à–µ–Ω—Å—Ç–≤–æ–≤–∞–Ω–∏–µ —É—Ä–æ–≤–Ω—è –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ–π –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –ú–ß–° –ø—Ä–∏ –ø—Ä–æ–≤–µ–¥–µ–Ω–∏–∏ –∞–≤–∞—Ä–∏–π–Ω–æ-—Å–ø–∞—Å–∞—Ç–µ–ª—å–Ω—ã—Ö —Ä–∞–±–æ—Ç –ø–æ –ª–∏–∫–≤–∏–¥–∞—Ü–∏–∏ –ø–æ—Å–ª–µ–¥—Å—Ç–≤–∏–π –¥–æ—Ä–æ–∂–Ω–æ-—Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω—ã—Ö –ø—Ä–æ–∏—à–µ—Å—Ç–≤–∏–π, —Å–æ–∫—Ä–∞—â–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π —Ä–µ–∞–≥–∏—Ä–æ–≤–∞–Ω–∏—è. | –û—Å–Ω–æ–≤–Ω–∞—è —Ü–µ–ª—å –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è - –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∞—è –æ—Ç—Ä–∞–±–æ—Ç–∫–∞ –Ω–∞–≤—ã–∫–æ–≤ –ø–æ –æ–∫–∞–∑–∞–Ω–∏—é –ø–æ–º–æ—â–∏ –≥—Ä–∞–∂–¥–∞–Ω–∞–º, –ø–æ–ø–∞–≤—à–∏–º –≤ –î–¢–ü, –∞ —Ç–∞–∫–∂–µ –ø–æ–≤—ã—à–µ–Ω–∏–µ –∏ —Å–æ–≤–µ—Ä—à–µ–Ω—Å—Ç–≤–æ–≤–∞–Ω–∏–µ —É—Ä–æ–≤–Ω—è –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ–π –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –ú–ß–° –ø—Ä–∏ –ø—Ä–æ–≤–µ–¥–µ–Ω–∏–∏ –∞–≤–∞—Ä–∏–π–Ω–æ-—Å–ø–∞—Å–∞—Ç–µ–ª—å–Ω—ã—Ö —Ä–∞–±–æ—Ç –ø–æ –ª–∏–∫–≤–∏–¥–∞—Ü–∏–∏ –ø–æ—Å–ª–µ–¥—Å—Ç–≤–∏–π –¥–æ—Ä–æ–∂–Ω–æ-—Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω—ã—Ö –ø—Ä–æ–∏—Å—à–µ—Å—Ç–≤–∏–π, —Å–æ–∫—Ä–∞—â–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π —Ä–µ–∞–≥–∏—Ä–æ–≤–∞–Ω–∏—è. |
+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| –ø—Ä–∏–π–¥—è –≤ –ú–ì–¢–£ —è –±—ã–ª —É–¥–∏–≤–ª–µ–Ω –Ω–∏–∫–æ–≥–æ –Ω–µ–æ–±–Ω–æ—Ä—É–∂–∏–≤ —Ç–∞–º‚Ä¶                                                                                                                                                                                                                                                                                                    | –ø—Ä–∏–¥—è –≤ –ú–ì–¢–£ —è –±—ã–ª —É–¥–∏–≤–ª–µ–Ω –Ω–∏–∫–æ–≥–æ –Ω–µ –æ–±–Ω–∞—Ä—É–∂–∏–≤ —Ç–∞–º                                                                                                                                                                                                                                                                                                       |
+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+


Metrics
^^^^^^^^^

Below are automatic metrics for determining the correctness of the spell checkers.
We compare our solution with both open automatic spell checkers and the ChatGPT family of models on all four available datasets:
- **RUSpellRU**: texts collected from (`LiveJournal <https://www.livejournal.com/media>`_), with manually corrected typos and errors;
- **MultidomainGold**: examples from 7 text sources, including the open web, news, social media, reviews, subtitles, policy documents and literary works;
- **MedSpellChecker**: texts with errors from medical anamnesis;
- **GitHubTypoCorpusRu**: spelling errors and typos in commits from GitHub;


**RUSpellRU**

+------------------+-----------+--------+------+
| Model            | Precision | Recall | F1   |
+==================+===========+========+======+
| sage-m2m100-1.2B | 88.8      | 71.5   | 79.2 |
+------------------+-----------+--------+------+
| sage-ai-service  | 93.5      | 82.4   | 87.6 |
+------------------+-----------+--------+------+
| gpt-3.5-turbo    | 39.6      | 62.3   | 48.5 |
+------------------+-----------+--------+------+
| gpt-4            | 69.5      | 81.0   | 74.8 |
+------------------+-----------+--------+------+
| Yandex.Speller   | 83.0      | 59.8   | 69.5 |
+------------------+-----------+--------+------+
| JamSpell         | 42.1      | 32.8   | 36.9 |
+------------------+-----------+--------+------+
| HunSpell         | 31.3      | 34.9   | 33.0 |
+------------------+-----------+--------+------+


**MultidomainGold**

+------------------+-----------+--------+------+
| Model            | Precision | Recall | F1   |
+==================+===========+========+======+
| sage-m2m100-1.2B | 63.8      | 61.1   | 62.4 |
+------------------+-----------+--------+------+
| sage-ai-service  | 70.9      | 68.8   | 69.9 |
+------------------+-----------+--------+------+
| gpt-3.5-turbo    | 17.8      | 56.1   | 27.0 |
+------------------+-----------+--------+------+
| gpt-4            | 31.1      | 78.1   | 44.5 |
+------------------+-----------+--------+------+
| Yandex.Speller   | 52.9      | 51.4   | 52.2 |
+------------------+-----------+--------+------+
| JamSpell         | 25.7      | 30.6   | 28.0 |
+------------------+-----------+--------+------+
| HunSpell         | 16.2      | 40.1   | 23.0 |
+------------------+-----------+--------+------+


**MedSpellChecker**

+------------------+-----------+--------+------+
| Model            | Precision | Recall | F1   |
+==================+===========+========+======+
| sage-m2m100-1.2B | 78.8      | 71.4   | 74.9 |
+------------------+-----------+--------+------+
| sage-ai-service  | 73.4      | 76.2   | 74.9 |
+------------------+-----------+--------+------+
| gpt-3.5-turbo    | 15.1      | 53.6   | 23.5 |
+------------------+-----------+--------+------+
| gpt-4            | 48.9      | 88.7   | 63.1 |
+------------------+-----------+--------+------+
| Yandex.Speller   | 80.6      | 47.8   | 60.0 |
+------------------+-----------+--------+------+
| JamSpell         | 24.6      | 29.7   | 26.9 |
+------------------+-----------+--------+------+
| HunSpell         | 10.3      | 40.2   | 16.4 |
+------------------+-----------+--------+------+


**GitHubTypoCorpusRu**

+------------------+-----------+--------+------+
| Model            | Precision | Recall | F1   |
+==================+===========+========+======+
| sage-m2m100-1.2B | 47.1      | 42.9   | 44.9 |
+------------------+-----------+--------+------+
| sage-ai-service  | 76.1      | 51.2   | 61.2 |
+------------------+-----------+--------+------+
| gpt-3.5-turbo    | 23.7      | 43.9   | 30.8 |
+------------------+-----------+--------+------+
| gpt-4            | 34.7      | 60.5   | 44.1 |
+------------------+-----------+--------+------+
| Yandex.Speller   | 67.7      | 37.5   | 48.3 |
+------------------+-----------+--------+------+
| JamSpell         | 49.5      | 29.9   | 37.3 |
+------------------+-----------+--------+------+
| HunSpell         | 28.5      | 30.7   | 29.6 |
+------------------+-----------+--------+------+



How to use
^^^^^^^^^^^^

.. code-block:: python

    from transformers import M2M100ForConditionalGeneration, M2M100Tokenizer

    path_to_model = "ai-forever/sage-m2m100-1.2B"
    model = M2M100ForConditionalGeneration.from_pretrained(path_to_model)

    tokenizer = M2M100Tokenizer.from_pretrained(path_to_model, src_lang="ru", tgt_lang="ru")
    sentence = "–ø—Ä–∏–π–¥—è –≤ –ú–ì–¢–£ —è –±—ã–ª —É–¥–∏–≤–ª–µ–Ω –Ω–∏–∫–æ–≥–æ –Ω–µ–æ–±–Ω–æ—Ä—É–∂–∏–≤ —Ç–∞–º‚Ä¶"
    encodings = tokenizer(sentence, return_tensors="pt")
    generated_tokens = model.generate(
            **encodings, forced_bos_token_id=tokenizer.get_lang_id("ru"))
    answer = tokenizer.batch_decode(generated_tokens, skip_special_tokens=True)
    print(answer)

    #["–ø—Ä–∏–π–¥—è –≤ –ú–ì–¢–£ —è –±—ã–ª —É–¥–∏–≤–ª–µ–Ω –Ω–∏–∫–æ–≥–æ –Ω–µ –æ–±–Ω–∞—Ä—É–∂–∏–≤ —Ç–∞–º..."]


API
^^^^^

.. autoclass:: sage.spelling_correction.m2m_correctors.RuM2M100ModelForSpellingCorrection
    :members:
    :inherited-members:
    :show-inheritance:


Limitations
^^^^^^^^^^^^

- Complex formatting may cause some trouble in output generation.


Resources
^^^^^^^^^^^^

- `SAGE library <https://github.com/ai-forever/sage>`_, GitHub
- `sage-fredt5-large <https://huggingface.co/ai-forever/sage-fredt5-large>`_, HuggingFace
- `sage-fredt5-distilled-95m <https://huggingface.co/ai-forever/sage-fredt5-distilled-95m>`_, HuggingFace
- `sage-m2m100-1.2B <https://huggingface.co/ai-forever/sage-m2m100-1.2B>`_, HuggingFace
- `sage-mt5-large <https://huggingface.co/ai-forever/sage-mt5-large>`_, HuggingFace


License
^^^^^^^^^

Model `M2M100-1.2B <https://huggingface.co/facebook/m2m100_1.2B>`_, on the basis of which our solution is made, and its source code are supplied under the MIT license.
Our solution also comes with MIT license.

Specifications
^^^^^^^^^^^^^^^
- File size: 5 Gb;
- Framework: pytorch
- Format: AI Service
- Version: v2.0
- Developer: SberDevices, AGI NLP

Contacts
^^^^^^^^^^^
nikita.martynov.98@list.ru

