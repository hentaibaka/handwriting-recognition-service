import{j as e,H as I,c as p,f as R,r as T,B as F,I as _}from"./index-p7H9IJxa.js";import{C as k,F as g,M as d,a as f,u as O,d as A,s as U}from"./validation-Eb4fYfVm.js";import{P as V,a as j}from"./PasswordComplexity-aIPHZdOX.js";import{u as $}from"./useMutation-BY5_vBK1.js";import{u as D}from"./useSignIn-DLmMQUON.js";import{r as H,O as K}from"./request-CHWoY4Yq.js";class G{static registerCreate(t){return H(K,{method:"POST",url:"/api/register/",body:t,mediaType:"application/json"})}}const W=({control:s,name:t,rules:a,disabled:c,labelSlot:m})=>e.jsx(k,{control:s,name:t,rules:a,render:({field:i,fieldState:{error:l}})=>e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-[10px]",children:[e.jsx(I,{id:t,checked:!!i.value,className:p(l&&"border-error"),disabled:c,...i,onCheckedChange:u=>i.onChange(u)}),m]}),e.jsx("span",{className:"h-[20px] block text-sm break-words text-error mt-[4px]",children:l==null?void 0:l.message})]})}),z=()=>{const{isPending:s,signIn:t}=D(),{toast:a}=R(),{isPending:c,mutate:m}=$({mutationFn:i=>G.registerCreate(i),onSuccess:(i,l)=>{t({email:l.email,password:l.password})},onError:i=>{const l=i;l.body||console.error(i);for(const u in l.body)a({title:"Ошибка регистрации",description:l.body[u]||"Неизвестная ошибка"})}});return{isPending:c||s,signUp:m}},n={firstName:{name:"firstName",label:"Имя"},lastName:{name:"lastName",label:"Фамилия"},middleName:{name:"middleName",label:"Отчество"},email:{name:"email",label:"E-mail"},password:{name:"password",label:"Пароль"},repeatPassword:{name:"repeatPassword",label:"Повторите пароль"},agreementTerms:{name:"agreementTerms",label:""}},B="",J=({control:s,disabled:t,onFieldChange:a})=>e.jsx(g,{control:s,name:n.firstName.name,label:n.firstName.label,rules:{required:"Это поле обязательное",minLength:{value:d,message:`Поле не может быть короче ${d} символов`}},disabled:t,onFieldChange:a}),Q=({control:s,disabled:t,onFieldChange:a})=>e.jsx(g,{control:s,name:n.lastName.name,label:n.lastName.label,rules:{required:"Это поле обязательное",minLength:{value:d,message:`Поле не может быть короче ${d} символов`}},disabled:t,onFieldChange:a}),X=({control:s,disabled:t,onFieldChange:a})=>e.jsx(g,{control:s,name:n.middleName.name,label:n.middleName.label,rules:{required:"Это поле обязательное",minLength:{value:d,message:`Поле не может быть короче ${d} символов`}},disabled:t,onFieldChange:a}),Y=({control:s,disabled:t,onFieldChange:a})=>e.jsx(g,{control:s,name:n.email.name,label:n.email.label,rules:{required:"Это поле обязательное",minLength:{value:d,message:`Поле не может быть короче ${d} символов`}},disabled:t,onFieldChange:a}),Z=({control:s,disabled:t,onFieldChange:a})=>e.jsx(g,{control:s,name:n.password.name,label:n.password.label,rules:{required:"Это поле обязательное",minLength:{value:f,message:`Пароль не может быть короче ${f} символов`}},disabled:t,onFieldChange:a}),ee=({control:s,disabled:t,onFieldChange:a})=>e.jsx(g,{control:s,name:n.repeatPassword.name,label:n.repeatPassword.label,rules:{required:"Это поле обязательное",validate:(c,m)=>c===m[n.password.name]?!0:"Пароли должны совпадать"},disabled:t,onFieldChange:a}),se=({control:s,disabled:t,labelSlot:a})=>e.jsx(W,{control:s,disabled:t,name:n.agreementTerms.name,labelSlot:a,rules:{required:"Это поле обязательное"}}),ae={firstName:"",lastName:"",middleName:"",email:"",password:"",repeatPassword:"",agreementTerms:!1},te=({className:s,renderButtonSlot:t})=>{const{control:a,handleSubmit:c,getValues:m,trigger:i}=O({defaultValues:ae,reValidateMode:"onChange",mode:"onChange"}),[l,u]=T.useState({minPasswordLength:!1,notIncludeNameAndEmail:!0,containsNumberOrSymbol:!1,passwordStrength:"Слабая"}),{isPending:o,signUp:S}=z(),y=r=>{const x=r.length>=f,b=m(n.email.name),h=m(n.firstName.name),N=!!b&&r.includes(b),M=!!h&&r.includes(h),E=!N&&!M,L=A.test(r),q=U.test(r);return{isMatchPasswordLength:x,isMatchNotIncludeNameAndEmail:E,isMatchContainsNumberOrSymbol:L||q}},C=()=>i(n.repeatPassword.name),w=r=>{r&&C();const{isMatchContainsNumberOrSymbol:x,isMatchNotIncludeNameAndEmail:b,isMatchPasswordLength:h}=y(r),N=[h,b,x].filter(Boolean).length;u({containsNumberOrSymbol:x,notIncludeNameAndEmail:b,minPasswordLength:h,passwordStrength:N<=1?"Слабая":N===2?"Нормальная":"Сильная"})},P=()=>w(m(n.password.name)),v=r=>{const x={email:r.email,first_name:r.firstName,last_name:r.lastName,middle_name:r.middleName,password:r.password};S(x)};return e.jsxs("form",{className:s,onSubmit:c(v),children:[e.jsxs("div",{className:p("mb-[38px] grid gap-x-[17px] gap-y-[12px] sm:gap-y-[20px] md:gap-y-[10px]","sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-[repeat(3,_318px)]"),children:[e.jsx(Q,{disabled:o,control:a}),e.jsx(J,{disabled:o,control:a,onFieldChange:P}),e.jsx(X,{disabled:o,control:a}),e.jsx(Y,{disabled:o,control:a,onFieldChange:P}),e.jsx(Z,{disabled:o,control:a,onFieldChange:w}),e.jsx(ee,{disabled:o,control:a})]}),e.jsxs(V,{className:"mb-[38px] grid md:grid-cols-[repeat(2,_300px)] gap-x-[17px] gap-y-[10px]",children:[e.jsx(j,{isMeetRequirements:l.passwordStrength!=="Слабая",customLabel:e.jsxs("div",{children:[e.jsx("span",{children:"Надежность пароля: "}),e.jsx("span",{className:p(l.passwordStrength==="Слабая"&&"text-error"),children:l.passwordStrength})]})}),e.jsx(j,{isMeetRequirements:l.minPasswordLength,label:"Минимум 8 символов"}),e.jsx(j,{isMeetRequirements:l.notIncludeNameAndEmail,label:"Не может содержать ваше имя или адрес электронной почты"}),e.jsx(j,{isMeetRequirements:l.containsNumberOrSymbol,label:"Содержит число или символ"})]}),e.jsx("div",{className:"mb-[8px]",children:e.jsx(se,{disabled:o,control:a,labelSlot:e.jsxs("div",{className:"text-[0.6875rem] leading-[0.9rem] text-additional-color-7 font-medium",children:[e.jsx("label",{className:"block",htmlFor:n.agreementTerms.name,children:"Регистрируясь для создания учетной записи, я принимаю"}),e.jsx("a",{href:B,target:"_blank",className:"font-semibold text-additional-color-4",children:"Условия использования и Политику конфиденциальности Компании"})]})})}),e.jsxs("div",{className:"flex flex-wrap gap-[23px]",children:[e.jsx(F,{type:"submit",disabled:o,className:"uppercase",children:"Зарегистрироваться"}),t==null?void 0:t({disabled:o})]})]})},ne=s=>e.jsxs(F,{type:"button",className:p("bg-additional-color-1 text-accent hover:bg-additional-color-1","disabled:bg-additional-color-1/80 disabled:text-accent/60"),...s,children:[e.jsx(_,{iconName:"vk-logo",className:p("mr-[10px] h-[30px] w-[30px]",s.disabled&&"opacity-60")}),"Войти через VK ID"]}),pe=()=>e.jsxs("div",{className:"py-[30px] px-[16px] sm:py-[30px] sm:px-[50px] lg:py-[27px] lg:px-[66px]",children:[e.jsx(le,{className:"mb-[13px]"}),e.jsx(te,{className:"mb-[83px]",renderButtonSlot:({disabled:s})=>e.jsx(ne,{disabled:s})})]}),le=({className:s})=>e.jsx("div",{className:p("text-additional-color-2  font-medium","text-[1.1rem] md:text-[1.3rem] lg:text-[1.375rem] lg:leading-[1.75rem]",s),children:"Регистрация"});export{pe as default};
