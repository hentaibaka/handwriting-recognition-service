import{j as e,x as q,c as j,a as I,O as R,g as T,r as _,B as k,y as O}from"./index-DUDia-6_.js";import{C as A,F as p,M as d,a as w,u as U,d as $,s as D}from"./validation-Dc6vHycW.js";import{P as V,a as N}from"./PasswordComplexity-Cohp1xyn.js";import{u as G}from"./useMutation-BPfTpUlQ.js";import{u as H}from"./useSignIn-uH-9V9wg.js";const B=({control:n,name:a,rules:s,disabled:c,labelSlot:m})=>e.jsx(A,{control:n,name:a,rules:s,render:({field:i,fieldState:{error:l}})=>e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-[10px]",children:[e.jsx(q,{id:a,checked:!!i.value,className:j(l&&"border-error"),disabled:c,...i,onCheckedChange:g=>i.onChange(g)}),m]}),e.jsx("span",{className:"h-[20px] block text-sm break-words text-error mt-[4px]",children:l==null?void 0:l.message})]})});class K{static registerCreate(a){return I(R,{method:"POST",url:"/api/register/",body:a,mediaType:"application/json"})}}const W=()=>{const{isPending:n,signIn:a}=H(),{toast:s}=T(),{isPending:c,mutate:m}=G({mutationFn:i=>K.registerCreate(i),onSuccess:(i,l)=>{a({email:l.email,password:l.password})},onError:i=>{const l=i;l.body||console.error(i);for(const g in l.body)s({title:"Ошибка регистрации",description:l.body[g]||"Неизвестная ошибка"})}});return{isPending:c||n,signUp:m}},t={firstName:{name:"firstName",label:"Имя"},lastName:{name:"lastName",label:"Фамилия"},middleName:{name:"middleName",label:"Отчество"},email:{name:"email",label:"E-mail"},password:{name:"password",label:"Пароль"},repeatPassword:{name:"repeatPassword",label:"Повторите пароль"},agreementTerms:{name:"agreementTerms",label:""}},z="",J=({control:n,disabled:a,onFieldChange:s})=>e.jsx(p,{control:n,name:t.firstName.name,label:t.firstName.label,rules:{required:"Это поле обязательное",minLength:{value:d,message:`Поле не может быть короче ${d} символов`}},disabled:a,onFieldChange:s}),Q=({control:n,disabled:a,onFieldChange:s})=>e.jsx(p,{control:n,name:t.lastName.name,label:t.lastName.label,rules:{required:"Это поле обязательное",minLength:{value:d,message:`Поле не может быть короче ${d} символов`}},disabled:a,onFieldChange:s}),X=({control:n,disabled:a,onFieldChange:s})=>e.jsx(p,{control:n,name:t.middleName.name,label:t.middleName.label,rules:{required:"Это поле обязательное",minLength:{value:d,message:`Поле не может быть короче ${d} символов`}},disabled:a,onFieldChange:s}),Y=({control:n,disabled:a,onFieldChange:s})=>e.jsx(p,{control:n,name:t.email.name,label:t.email.label,rules:{required:"Это поле обязательное",minLength:{value:d,message:`Поле не может быть короче ${d} символов`}},disabled:a,onFieldChange:s}),Z=({control:n,disabled:a,onFieldChange:s})=>e.jsx(p,{control:n,name:t.password.name,label:t.password.label,rules:{required:"Это поле обязательное",minLength:{value:w,message:`Пароль не может быть короче ${w} символов`}},disabled:a,onFieldChange:s}),ee=({control:n,disabled:a,onFieldChange:s})=>e.jsx(p,{control:n,name:t.repeatPassword.name,label:t.repeatPassword.label,rules:{required:"Это поле обязательное",validate:(c,m)=>c===m[t.password.name]?!0:"Пароли должны совпадать"},disabled:a,onFieldChange:s}),se=({control:n,disabled:a,labelSlot:s})=>e.jsx(B,{control:n,disabled:a,name:t.agreementTerms.name,labelSlot:s,rules:{required:"Это поле обязательное"}}),ae={firstName:"",lastName:"",middleName:"",email:"",password:"",repeatPassword:"",agreementTerms:!1},ne=({className:n,renderButtonSlot:a})=>{const{control:s,handleSubmit:c,getValues:m,trigger:i}=U({defaultValues:ae,reValidateMode:"onChange",mode:"onChange"}),[l,g]=_.useState({minPasswordLength:!1,notIncludeNameAndEmail:!0,containsNumberOrSymbol:!1,passwordStrength:"Слабая"}),{isPending:o,signUp:F}=W(),S=r=>{const x=r.length>=w,u=m(t.email.name),h=m(t.firstName.name),b=!!u&&r.includes(u),M=!!h&&r.includes(h),v=!b&&!M,E=$.test(r),L=D.test(r);return{isMatchPasswordLength:x,isMatchNotIncludeNameAndEmail:v,isMatchContainsNumberOrSymbol:E||L}},y=()=>i(t.repeatPassword.name),f=r=>{r&&y();const{isMatchContainsNumberOrSymbol:x,isMatchNotIncludeNameAndEmail:u,isMatchPasswordLength:h}=S(r),b=[h,u,x].filter(Boolean).length;g({containsNumberOrSymbol:x,notIncludeNameAndEmail:u,minPasswordLength:h,passwordStrength:b<=1?"Слабая":b===2?"Нормальная":"Сильная"})},P=()=>f(m(t.password.name)),C=r=>{const x={email:r.email,first_name:r.firstName,last_name:r.lastName,middle_name:r.middleName,password:r.password};F(x)};return e.jsxs("form",{className:n,onSubmit:c(C),children:[e.jsxs("div",{className:j("mb-[38px] grid gap-x-[17px] gap-y-[12px] sm:gap-y-[20px] md:gap-y-[10px]","sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-[repeat(3,_318px)]"),children:[e.jsx(Q,{disabled:o,control:s}),e.jsx(J,{disabled:o,control:s,onFieldChange:P}),e.jsx(X,{disabled:o,control:s}),e.jsx(Y,{disabled:o,control:s,onFieldChange:P}),e.jsx(Z,{disabled:o,control:s,onFieldChange:f}),e.jsx(ee,{disabled:o,control:s})]}),e.jsxs(V,{className:"mb-[38px] grid md:grid-cols-[repeat(2,_300px)] gap-x-[17px] gap-y-[10px]",children:[e.jsx(N,{isMeetRequirements:l.passwordStrength!=="Слабая",customLabel:e.jsxs("div",{children:[e.jsx("span",{children:"Надежность пароля: "}),e.jsx("span",{className:j(l.passwordStrength==="Слабая"&&"text-error"),children:l.passwordStrength})]})}),e.jsx(N,{isMeetRequirements:l.minPasswordLength,label:"Минимум 8 символов"}),e.jsx(N,{isMeetRequirements:l.notIncludeNameAndEmail,label:"Не может содержать ваше имя или адрес электронной почты"}),e.jsx(N,{isMeetRequirements:l.containsNumberOrSymbol,label:"Содержит число или символ"})]}),e.jsx("div",{className:"mb-[8px]",children:e.jsx(se,{disabled:o,control:s,labelSlot:e.jsxs("div",{className:"text-[0.6875rem] leading-[0.9rem] text-additional-color-7 font-medium",children:[e.jsx("label",{className:"block",htmlFor:t.agreementTerms.name,children:"Регистрируясь для создания учетной записи, я принимаю"}),e.jsx("a",{href:z,target:"_blank",className:"font-semibold text-additional-color-4",children:"Условия использования и Политику конфиденциальности Компании"})]})})}),e.jsxs("div",{className:"flex flex-wrap gap-[23px]",children:[e.jsx(k,{type:"submit",disabled:o,className:"uppercase",children:"Зарегистрироваться"}),a==null?void 0:a({disabled:o})]})]})},ce=()=>e.jsxs("div",{className:"py-[30px] px-[16px] sm:py-[30px] sm:px-[50px] lg:py-[27px] lg:px-[66px]",children:[e.jsx(te,{className:"mb-[13px]"}),e.jsx(ne,{className:"mb-[83px]",renderButtonSlot:({disabled:n})=>O})]}),te=({className:n})=>e.jsx("div",{className:j("text-additional-color-2  font-medium","text-[1.1rem] md:text-[1.3rem] lg:text-[1.375rem] lg:leading-[1.75rem]",n),children:"Регистрация"});export{ce as default};
