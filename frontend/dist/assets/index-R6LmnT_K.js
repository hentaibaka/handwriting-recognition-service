import{j as e,G as E,c as g,r as R,B as F,I as T}from"./index-DZk8EHuN.js";import{C as _,F as p,M as o,a as w,u as k,d as O,s as A}from"./validation-CEv4JjkA.js";import{u as U}from"./useMutation-DPUchMzF.js";import{u as V}from"./useSignIn-oXJvNznu.js";import{r as $,O as D}from"./request-CMsvLA07.js";import{P as G,a as N}from"./PasswordComplexity-BAOJHASq.js";class H{static registerCreate(n){return $(D,{method:"POST",url:"/api/register/",body:n,mediaType:"application/json"})}}const K=({control:s,name:n,rules:a,disabled:c,labelSlot:r})=>e.jsx(_,{control:s,name:n,rules:a,render:({field:d,fieldState:{error:i}})=>e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-[10px]",children:[e.jsx(E,{id:n,checked:!!d.value,className:g(i&&"border-error"),disabled:c,...d,onCheckedChange:j=>d.onChange(j)}),r]}),e.jsx("span",{className:"h-[20px] block text-sm break-words text-error mt-[4px]",children:i==null?void 0:i.message})]})}),W=()=>{const{isPending:s,signIn:n}=V(),{isPending:a,mutate:c}=U({mutationFn:r=>H.registerCreate(r),onSuccess:(r,d)=>{n({email:d.email,password:d.password})}});return{isPending:a||s,signUp:c}},t={firstName:{name:"firstName",label:"Имя"},lastName:{name:"lastName",label:"Фамилия"},middleName:{name:"middleName",label:"Отчество"},email:{name:"email",label:"E-mail"},password:{name:"password",label:"Пароль"},repeatPassword:{name:"repeatPassword",label:"Повторите пароль"},agreementTerms:{name:"agreementTerms",label:""}},z="",B=({control:s,disabled:n,onFieldChange:a})=>e.jsx(p,{control:s,name:t.firstName.name,label:t.firstName.label,rules:{required:"Это поле обязательное",minLength:{value:o,message:`Поле не может быть короче ${o} символов`}},disabled:n,onFieldChange:a}),J=({control:s,disabled:n,onFieldChange:a})=>e.jsx(p,{control:s,name:t.lastName.name,label:t.lastName.label,rules:{required:"Это поле обязательное",minLength:{value:o,message:`Поле не может быть короче ${o} символов`}},disabled:n,onFieldChange:a}),Q=({control:s,disabled:n,onFieldChange:a})=>e.jsx(p,{control:s,name:t.middleName.name,label:t.middleName.label,rules:{required:"Это поле обязательное",minLength:{value:o,message:`Поле не может быть короче ${o} символов`}},disabled:n,onFieldChange:a}),X=({control:s,disabled:n,onFieldChange:a})=>e.jsx(p,{control:s,name:t.email.name,label:t.email.label,rules:{required:"Это поле обязательное",minLength:{value:o,message:`Поле не может быть короче ${o} символов`}},disabled:n,onFieldChange:a}),Y=({control:s,disabled:n,onFieldChange:a})=>e.jsx(p,{control:s,name:t.password.name,label:t.password.label,rules:{required:"Это поле обязательное",minLength:{value:w,message:`Пароль не может быть короче ${w} символов`}},disabled:n,onFieldChange:a}),Z=({control:s,disabled:n,onFieldChange:a})=>e.jsx(p,{control:s,name:t.repeatPassword.name,label:t.repeatPassword.label,rules:{required:"Это поле обязательное",validate:(c,r)=>c===r[t.password.name]?!0:"Пароли должны совпадать"},disabled:n,onFieldChange:a}),ee=({control:s,disabled:n,labelSlot:a})=>e.jsx(K,{control:s,disabled:n,name:t.agreementTerms.name,labelSlot:a,rules:{required:"Это поле обязательное"}}),se={firstName:"",lastName:"",middleName:"",email:"",password:"",repeatPassword:"",agreementTerms:!1},ae=({className:s,renderButtonSlot:n})=>{const{control:a,handleSubmit:c,getValues:r,trigger:d}=k({defaultValues:se,reValidateMode:"onChange",mode:"onChange"}),[i,j]=R.useState({minPasswordLength:!1,notIncludeNameAndEmail:!0,containsNumberOrSymbol:!1,passwordStrength:"Слабая"}),{isPending:m,signUp:S}=W(),C=l=>{const x=l.length>=w,u=r(t.email.name),b=r(t.firstName.name),h=!!u&&l.includes(u),M=!!b&&l.includes(b),L=!h&&!M,q=O.test(l),I=A.test(l);return{isMatchPasswordLength:x,isMatchNotIncludeNameAndEmail:L,isMatchContainsNumberOrSymbol:q||I}},y=()=>d(t.repeatPassword.name),f=l=>{l&&y();const{isMatchContainsNumberOrSymbol:x,isMatchNotIncludeNameAndEmail:u,isMatchPasswordLength:b}=C(l),h=[b,u,x].filter(Boolean).length;j({containsNumberOrSymbol:x,notIncludeNameAndEmail:u,minPasswordLength:b,passwordStrength:h<=1?"Слабая":h===2?"Нормальная":"Сильная"})},P=()=>f(r(t.password.name)),v=l=>{const x={email:l.email,first_name:l.firstName,last_name:l.lastName,middle_name:l.middleName,password:l.password};S(x)};return e.jsxs("form",{className:s,onSubmit:c(v),children:[e.jsxs("div",{className:g("mb-[38px] grid gap-x-[17px] gap-y-[12px] sm:gap-y-[20px] md:gap-y-[10px]","sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-[repeat(3,_318px)]"),children:[e.jsx(J,{disabled:m,control:a}),e.jsx(B,{disabled:m,control:a,onFieldChange:P}),e.jsx(Q,{disabled:m,control:a}),e.jsx(X,{disabled:m,control:a,onFieldChange:P}),e.jsx(Y,{disabled:m,control:a,onFieldChange:f}),e.jsx(Z,{disabled:m,control:a})]}),e.jsxs(G,{className:"mb-[38px] grid md:grid-cols-[repeat(2,_300px)] gap-x-[17px] gap-y-[10px]",children:[e.jsx(N,{isMeetRequirements:i.passwordStrength!=="Слабая",customLabel:e.jsxs("div",{children:[e.jsx("span",{children:"Надежность пароля: "}),e.jsx("span",{className:g(i.passwordStrength==="Слабая"&&"text-error"),children:i.passwordStrength})]})}),e.jsx(N,{isMeetRequirements:i.minPasswordLength,label:"Минимум 8 символов"}),e.jsx(N,{isMeetRequirements:i.notIncludeNameAndEmail,label:"Не может содержать ваше имя или адрес электронной почты"}),e.jsx(N,{isMeetRequirements:i.containsNumberOrSymbol,label:"Содержит число или символ"})]}),e.jsx("div",{className:"mb-[8px]",children:e.jsx(ee,{disabled:m,control:a,labelSlot:e.jsxs("div",{className:"text-[0.6875rem] leading-[0.9rem] text-additional-color-7 font-medium",children:[e.jsx("label",{className:"block",htmlFor:t.agreementTerms.name,children:"Регистрируясь для создания учетной записи, я принимаю"}),e.jsx("a",{href:z,target:"_blank",className:"font-semibold text-additional-color-4",children:"Условия использования и Политику конфиденциальности Компании"})]})})}),e.jsxs("div",{className:"flex flex-wrap gap-[23px]",children:[e.jsx(F,{type:"submit",disabled:m,className:"uppercase",children:"Зарегистрироваться"}),n==null?void 0:n({disabled:m})]})]})},ne=s=>e.jsxs(F,{type:"button",className:g("bg-additional-color-1 text-accent hover:bg-additional-color-1","disabled:bg-additional-color-1/80 disabled:text-accent/60"),...s,children:[e.jsx(T,{iconName:"vk-logo",className:g("mr-[10px] h-[30px] w-[30px]",s.disabled&&"opacity-60")}),"Войти через VK ID"]}),xe=()=>e.jsxs("div",{className:"py-[30px] px-[16px] sm:py-[30px] sm:px-[50px] lg:py-[27px] lg:px-[66px]",children:[e.jsx(te,{className:"mb-[13px]"}),e.jsx(ae,{className:"mb-[83px]",renderButtonSlot:({disabled:s})=>e.jsx(ne,{disabled:s})})]}),te=({className:s})=>e.jsx("div",{className:g("text-additional-color-2  font-medium","text-[1.1rem] md:text-[1.3rem] lg:text-[1.375rem] lg:leading-[1.75rem]",s),children:"Регистрация"});export{xe as default};
